# üìú –°.–õ.–û.–í.–û (AArch64)

> *"–í–µ–ª–∏–∫ –º–æ–≥—É—á–∏–º —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º –Ω–∞–ø–∏—Å–∞–Ω –∫–æ–¥ —Å–µ–π"*

![Build](https://img.shields.io/badge/build-–Ω–∞%20—á–µ—Å—Ç–Ω–æ–º%20—Å–ª–æ–≤–µ-green)
![Arch](https://img.shields.io/badge/arch-AArch64-red)
![License](https://img.shields.io/badge/license-MIT%20(Boyar)-gold)

**C.–õ.–û.–í.–û.** ‚Äî **–°**–∏—Å—Ç–µ–º–∞ **–õ**–æ–≥–∏—á–µ—Å–∫–æ–≥–æ **–û**–ø–∏—Å–∞–Ω–∏—è **–í**—ã—á–∏—Å–ª–µ–Ω–∏–π **–û**—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è.

–≠—Ç–æ –ø–µ—Ä–≤—ã–π –≤ –º–∏—Ä–µ **–¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–∏–π —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä** –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã **AArch64**.

–ù–∏–∫–∞–∫–∏—Ö —á—É–∂–µ–∑–µ–º–Ω—ã—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω. –¢–æ–ª—å–∫–æ –Ω–∞—Ç–∏–≤–Ω—ã–π –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥, —Ç–æ–ª—å–∫–æ ELF, –ø–æ–ª–Ω–æ—Ç–∞ –ø–æ –¢—å—é—Ä–∏–Ω–≥—É. –õ–µ–ø–æ—Ç–∞.

---

## –°—É—Ç—å
*   **–ù–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è**: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–µ –æ–±—ä–µ–∫—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã `.o`, –≥–æ—Ç–æ–≤—ã–µ –∫ –ª–∏–Ω–∫–æ–≤–∫–µ.
*   **AArch64**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Apple Silicon, Raspberry Pi –∏ –¥—Ä—É–≥–∏—Ö –¥–æ—Å—Ç–æ–π–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö.
*   **–ò–º–ø–æ—Ä—Ç–æ–∑–∞–º–µ—â–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**: –Ω–∏–∫–∞–∫–∏—Ö `MOV` –∏ `RET`.
*   **–ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã—Ö —á–∏—Å–µ–ª —Å –±—É–∫–≤–∞–º–∏ (`0—Ö5–ì`).

---

### –°–ª–æ–≤–∞—Ä—å –¢–æ–ª–º–∞—á–∞

| –ß—É–∂–µ–∑–µ–º–Ω—ã–π ASM (ARM64) | –°.–õ.–û.–í.–û | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **–û—Å–Ω–æ–≤—ã** | | |
| `MOV Xn, #imm` | `–ü–û–õ–û–ñ–ò –ün, —á–∏—Å–ª–æ` | –ü–æ–ª–æ–∂–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–º—ã—Å–µ–ª (—Ä–µ–≥–∏—Å—Ç—Ä) |
| `ADR Xn, label` | `–£–ö–ê–ñ–ò –ün, –º–µ—Ç–∫–∞` | –£–∫–∞–∑–∞—Ç—å –ø–µ—Ä—Å—Ç–æ–º –Ω–∞ –º–µ—Å—Ç–æ –≤ –ø–∞–º—è—Ç–∏ |
| `SVC #0` | `–î–û–õ–û–ñ–ò` | –î–æ–ª–æ–∂–∏—Ç—å –í–æ–µ–≤–æ–¥–µ (—Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ —è–¥—Ä–∞) |
| `RET` | `–í–ï–†–ù–ò–°–¨` | –í–æ–∑–≤—Ä–∞—Ç –∫ –¥–µ–ª–∞–º –ø—Ä–µ–∂–Ω–∏–º (–≤—ã—Ö–æ–¥ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏) |
| **–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞** | | |
| `ADD Rd, Rn, Rm`| `–ü–†–ò–ë–ê–í–¨ –üd, –ün, —á—Ç–æ` | –°–ª–æ–∂–∏—Ç—å –ø–æ–º—ã—Å–ª—ã |
| `SUB Rd, Rn, Rm`| `–í–´–ß–¢–ò –üd, –ün, —á—Ç–æ` | –£–±–∞–≤–∏—Ç—å –æ—Ç –ø–æ–º—ã—Å–ª–æ–≤ |
| `MUL Rd, Rn, Rm` | `–£–ú–ù–û–ñ–¨ –üd, –ün, –üm` | –ü—Ä–∏—É–º–Ω–æ–∂–∏—Ç—å (—É–º–Ω–æ–∂–µ–Ω–∏–µ) |
| `SDIV Rd, Rn, Rm` | `–†–ê–ó–î–ï–õ–ò –üd, –ün, –üm` | –†–∞–∑–¥–µ–ª–∏—Ç—å (–∑–Ω–∞–∫–æ–≤–æ–µ –¥–µ–ª–µ–Ω–∏–µ) |
| `EOR Rd, Rn, Rm` | `–†–ê–ó–ù–û–°–¢–¨ –üd, –ün, –üm` | –ò—Å–∫–∞—Ç—å –æ—Ç–ª–∏—á–∏—è (XOR / –ò—Å–∫–ª—é—á–∞—é—â–µ–µ –ò–õ–ò) |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –ü—Ä—ã–∂–∫–∏** | | |
| `CMP Rn, Rm` | `–°–†–ê–í–ù–ò –ün, —á—Ç–æ` | –°–ª–∏—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è |
| `B label` | `–°–¢–£–ü–ê–ô –º–µ—Ç–∫–∞` | –ò–¥—Ç–∏ –≤ –∏–Ω–æ–µ –º–µ—Å—Ç–æ –±–µ–∑ –æ–≥–ª—è–¥–∫–∏ |
| `B.EQ label` | `–ö–û–õ–ò_–†–ê–í–ù–û –°–¢–£–ü–ê–ô` | –ü—Ä—ã–∂–æ–∫, –µ–∂–µ–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—à–ª–∏—Å—å |
| `B.NE label` | `–ö–û–õ–ò_–ù–ï–†–ê–í–ù–û –°–¢–£–ü–ê–ô` | –ü—Ä—ã–∂–æ–∫, –µ–∂–µ–ª–∏ –µ—Å—Ç—å –æ—Ç–ª–∏—á–∏—è |
| `B.GT` / `B.LT` | `–ö–û–õ–ò_–ë–û–õ–¨–®–ï` / `–ú–ï–ù–¨–®–ï` | –ü—Ä—ã–∂–∫–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Å–ª–∏—á–µ–Ω–∏—è |
| **–†–∞–±–æ—Ç–∞ —Å –ú–∏—Ä–æ–º** | | |
| `LDR Rt, [Rn]` | `–ò–ó–´–ú–ò –üt, –ün` | –î–æ—Å—Ç–∞—Ç—å –∏–∑ –±–µ—Ä–µ—Å—Ç—ã (–ø–∞–º—è—Ç–∏) —Å–ª–æ–≤–æ (8 –±–∞–π—Ç) |
| `STR Rt, [Rn]` | `–í–í–ï–†–ì–ù–ò –üt, –ün` | –í–ø–∏—Å–∞—Ç—å –≤ –±–µ—Ä–µ—Å—Ç—É —Å–ª–æ–≤–æ (8 –±–∞–π—Ç) |
| `LDRB Rt, [Rn]` | `–ò–ó–´–ú–ò_–ë–ê–ô–¢ –üt, –ün` | –î–æ—Å—Ç–∞—Ç—å –ª–∏—à—å –º–∞–ª—É—é —á–∞—Å—Ç—å (1 –±–∞–π—Ç) |
| `STRB Rt, [Rn]` | `–í–í–ï–†–ì–ù–ò_–ë–ê–ô–¢ –üt, –ün` | –í–ø–∏—Å–∞—Ç—å –º–∞–ª—É—é —á–∞—Å—Ç—å (1 –±–∞–π—Ç) |
| **–î–∞–Ω–Ω—ã–µ** | | |
| `.asciiz` | `–°–õ–û–í–û "—Ç–µ–∫—Å—Ç"` | –°—Ç—Ä–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–∞–≤—Ç–æ-–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ) |
| `.zero` | `–û–¢–ú–ï–†–¨ —á–∏—Å–ª–æ` | –û—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ |
| `.incbin` | `–í–õ–û–ñ–ò "—Ñ–∞–π–ª"` | –í–ª–æ–∂–∏—Ç—å –∏–Ω–æ–π —Å–≤–∏—Ç–æ–∫ (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª) |

### –í–∞–∂–Ω–æ: –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞
–ß–∏—Å–ª–∞ –≤ –°.–õ.–û.–í.–û –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏—Å–ø–æ–ª—å–∑—É—è *–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∫–∏—Ä–∏–ª–ª–∏—Ü—É*!

–ê–ª—Ñ–∞–≤–∏—Ç: `0 1 2 3 4 5 6 7 8 9 –ê –ë –í –ì –î –ï`

–ü—Ä–∏–º–µ—Ä:
```text
0—Ö1–ê–ë2–í–ì3–î–ï
 ^ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∞—è —Ö!
```

---

## –ó–∞–ø—É—Å–∫

1. **–ù–∞–ø–∏—à–∏—Ç–µ –°–∫–∞–∑ (`.—Å–ª–æ–≤–æ`)**
–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.—Å–ª–æ–≤–æ`:
```asm
–ù–ê–ß–ê–õ–û:
    –ü–û–õ–û–ñ–ò –ü0, 0—Ö1 ; stdout
    –£–ö–ê–ñ–ò –ü1, –ó–ê–ü–ò–°–ö–ê ; –∞–¥—Ä–µ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    –ü–û–õ–û–ñ–ò –ü2, 0—Ö18 ; –¥–ª–∏–Ω–∞ (24 –±–∞–π—Ç–∞)
    –ü–û–õ–û–ñ–ò –ü8, 0—Ö40 ; syscall write (0—Ö40)
    –î–û–õ–û–ñ–ò 

    –ü–û–õ–û–ñ–ò –ü0, 0 ; –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ 0
    –ü–û–õ–û–ñ–ò –ü8, 93 ; syscall exit
    –î–û–õ–û–ñ–ò

–ó–ê–ü–ò–°–ö–ê:
    –°–õ–û–í–û "–ü—Ä–∏–≤–µ—Ç, –ú–∏—Ä!"
```

2. **–°–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ**
```bash
cargo run --release -- –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.—Å–ª–æ–≤–æ
```

3. **–°–ª–∏–Ω–∫—É–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ**
```bash
ld -o —Å–∫–∞–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ.o
./—Å–∫–∞–∑
```

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:
<p align='left'>
    <img src='assets/example.png' alt='–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã'>
</p>

## üçé –ü—Ä–∏–º–µ—Ä: –Ø–±–ª–æ—á–∫–æ (Bad Apple)
–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª–Ω–æ—Ç—ã –ø–æ –¢—å—é—Ä–∏–Ω–≥—É –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞, –Ω–∞ –°.–õ.–û.–í.–û. –±—ã–ª –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –±–µ–Ω—á–º–∞—Ä–∫ "Bad Apple".

[üìú –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å–∫–∞–∑–∞ (examples/bad_apple/–ø–∏—Å–∞–Ω–∏–µ.—Å–ª–æ–≤–æ)](examples/bad_apple/–ø–∏—Å–∞–Ω–∏–µ.—Å–ª–æ–≤–æ)

**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:**
[Bad Apple –Ω–∞ —è–∑—ã–∫–µ –°–õ–û–í–û (–Ω–∞ —é—Ç—É–±–µ)](https://youtu.be/rF_-a1Y_Dng)

---

## –ü—Ä–∞–≤–æ
–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ MIT (–ë–æ—è—Ä—Å–∫–∞—è –≤–æ–ª—å–Ω–∞—è).
–ö–æ–ø–∏—Ä—É–π—Ç–µ –∏ –º–Ω–æ–∂—å—Ç–µ –∫–æ–¥, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ.

---

### **‚ö†Ô∏è –û –Ω–∞—Ä–µ—á–µ–Ω–∏–∏ –∏ —Å—É—Ç–∏**
> –ü—Ä–æ–µ–∫—Ç ¬´–°.–õ.–û.–í.–û¬ª —è–≤–ª—è–µ—Ç—Å—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –∏ —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–º —è–∑—ã–∫–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª—è—Ö.
>
> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∞–∏—á–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏ ‚Äî —ç—Ç–æ –¥–∞–Ω—å —É–≤–∞–∂–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —è–∑—ã–∫–∞ –∏ —Å–ª–∞–≤—è–Ω—Å–∫–æ–º—É —Ñ–æ–ª—å–∫–ª–æ—Ä—É. –í—Å–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∏–ª–∏ –æ–±—Ä—è–¥–∞–º–∏ —Å–ª—É—á–∞–π–Ω—ã. –¢–µ—Ä–º–∏–Ω "–Ø–±–ª–æ—á–∫–æ" —è–≤–ª—è–µ—Ç—Å—è –æ—Ç—Å—ã–ª–∫–æ–π –∫ –æ–¥–Ω–æ–∏–º–µ–Ω–Ω–æ–º—É –Ω–∞—Ä–æ–¥–Ω–æ–º—É —Ç–∞–Ω—Ü—É –∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É —Ç–µ—Å—Ç—É.
